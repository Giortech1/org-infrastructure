# AcademyAxis.io Monitoring and Cost Controls Solution

This document provides an overview of the comprehensive monitoring and cost control solution implemented for the AcademyAxis.io infrastructure on Google Cloud Platform, ensuring the monthly spend remains within the $300 USD budget limit.

## Solution Architecture

Our monitoring and cost controls solution consists of several integrated components:

1. **Enhanced Network Infrastructure Monitoring**: Extensions to the existing monitoring.tf in the network_infrastructure module
2. **Dedicated Cost Controls Module**: A new module focused specifically on budget management
3. **Automated Cost Optimization**: Scripts and workflows to proactively manage costs
4. **Comprehensive Dashboards**: Visualization of performance and spending metrics
5. **Multi-level Alerting System**: Proactive notifications at various budget thresholds

## Components Overview

### 1. Enhanced Network Infrastructure Monitoring

We extended the existing `terraform/modules/network_infrastructure/monitoring.tf` file with:

- Email notification channels for alerts
- Error rate and latency alert policies
- Uptime monitoring with immediate notification
- Resource usage dashboards for network services

These enhancements provide critical visibility into service performance while maintaining cost-efficiency.

### 2. Dedicated Cost Controls Module

The new `terraform/modules/cost_controls` module provides:

- Budget definition and management
- Cost monitoring dashboards
- Budget alerts at multiple thresholds (50%, 75%, 90%, 100%)
- Log management with environment-specific retention policies
- Tracking of expensive operations
- Resource scaling configurations optimized for each environment

### 3. Automated Cost Optimization

The `scripts/cost_optimization.sh` script enables:

- Detailed cost reporting across all projects
- Resource usage analysis to identify optimization opportunities
- Automated optimization of Cloud Run scaling, log retention, and storage
- Emergency cost-cutting measures for budget overrun scenarios

### 4. GitHub Workflow Integration

The `.github/workflows/cost-monitoring.yml` workflow provides:

- Weekly cost reports (Mondays)
- Bi-monthly budget checkpoints (1st and 15th)
- Automatic optimization when approaching budget limits
- Manual trigger options for on-demand reporting and optimization

## Implementation by Environment

### Development Environment

- **Budget**: $50 per application
- **Scaling**: Min instances = 0 (scales to zero)
- **Log Retention**: 7 days
- **Monitoring**: Basic metrics only
- **Cost Controls**: Aggressive log filtering, minimal resource allocation

### UAT Environment

- **Budget**: $50 per application
- **Scaling**: Min instances = 0 (scales to zero)
- **Log Retention**: 14 days
- **Monitoring**: Standard metrics
- **Cost Controls**: Log filtering, optimized resource allocation

### Production Environment

- **Budget**: $100 per application
- **Scaling**: Min instances = 1 (always running)
- **Log Retention**: 30 days
- **Monitoring**: Comprehensive metrics
- **Cost Controls**: Strategic resource allocation, standard log filtering

## Dashboards Overview

The solution provides multiple dashboards:

1. **Service Performance Dashboard**: Real-time metrics for Cloud Run services
2. **Cost Dashboard**: Current spending and trends
3. **Cost Optimization Dashboard**: Identifies saving opportunities
4. **Organization Overview Dashboard**: Holistic view of all services and environments

These dashboards are accessible through the Google Cloud Console.

## Alerting System

Our multi-level alerting system includes:

1. **Budget Alerts**: Notifications at 50%, 75%, 90%, and 100% of budget
2. **Performance Alerts**: Notifications for high error rates, latency issues
3. **Uptime Alerts**: Immediate notifications for service disruptions
4. **Resource Usage Alerts**: Notifications for abnormal resource consumption patterns

Alerts are delivered via email to designated recipients.

## Documentation and Best Practices

Comprehensive documentation has been created:

1. **Cost Management Guide**: Organization-wide cost management strategies
2. **Environment-Specific Cost Control READMEs**: Tailored guidance for each environment
3. **Optimization Procedures**: Step-by-step instructions for cost reduction

## Usage Instructions

### Monitoring Dashboards

Access the monitoring dashboards in the Google Cloud Console:

1. Go to the [Google Cloud Console](https://console.cloud.google.com/)
2. Navigate to Monitoring > Dashboards
3. Select the desired dashboard from the list

### Cost Reports

Regular cost reports are automatically generated by the GitHub workflow and can be accessed:

1. In the GitHub Actions workflow runs
2. As downloadable artifacts from completed workflow runs
3. Via email notifications sent to designated recipients

### Manual Optimization

To manually run cost optimization:

1. Trigger the GitHub workflow with the "optimize" action
2. Or run the script directly: `./scripts/cost_optimization.sh optimize`

### Emergency Cost-Cutting

In case of budget emergencies:

1. Trigger the GitHub workflow with the "emergency" action
2. Or run the script directly: `./scripts/cost_optimization.sh emergency`

## Maintenance and Updates

To keep the cost control system effective:

1. Review and update budgets quarterly
2. Adjust alerting thresholds as needed
3. Update optimization scripts as new services are added
4. Regularly test the emergency cost-cutting procedures

## Contribution Guidelines

To contribute to this solution:

1. Submit pull requests to the GitHub repository
2. Document all changes thoroughly
3. Test changes in development environment first
4. Ensure all cost control measures remain intact

## Contact Information

For questions or assistance with the monitoring and cost control solution:

- **DevOps Team**: devops@academyaxis.io
- **GitHub Repository**: [giortech1/org-infrastructure](https://github.com/giortech1/org-infrastructure)

## Conclusion

This comprehensive monitoring and cost control solution ensures that AcademyAxis.io infrastructure remains within the $300 USD monthly budget while providing high visibility into performance and spend. By implementing environment-specific optimizations, automated reporting, and proactive alerting, we've created a sustainable approach to cloud cost management.